"use strict";(()=>{var e={};e.id=147,e.ids=[147],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1212:e=>{e.exports=require("async_hooks")},1282:e=>{e.exports=require("child_process")},4770:e=>{e.exports=require("crypto")},665:e=>{e.exports=require("dns")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},3757:e=>{e.exports=import("prettier/plugins/html")},5747:e=>{e.exports=import("prettier/standalone")},4492:e=>{e.exports=require("node:stream")},5448:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>c,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>x,staticGenerationAsyncStorage:()=>d});var s=r(3278),a=r(5002),i=r(4877),n=r(2037),l=e([n]);n=(l.then?(await l)():l)[0];let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/check-email/route",pathname:"/api/check-email",filename:"route",bundlePath:"app/api/check-email/route"},resolvedPagePath:"D:\\aggi\\projects\\rotaract-member-payments\\app\\api\\check-email\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:x}=p,h="/api/check-email/route";function c(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:d})}o()}catch(e){o(e)}})},2037:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{POST:()=>c});var s=r(1309),a=r(9483),i=r(9628),n=r(7662),l=e([n]);n=(l.then?(await l)():l)[0];let p=i.z.object({email:i.z.string().email("Invalid email format")});async function c(e){try{console.log("check-email API called");let t=await e.json();console.log("Request body:",t);let r=p.safeParse(t);if(!r.success)return console.error("Validation error:",r.error),s.NextResponse.json({status:!1,error:"Invalid email format"},{status:400});let{email:o}=r.data;console.log("Validated email:",o);let i=await a._.user.findUnique({where:{email:o}});if(console.log("Fetched user:",i),!i)return console.log("User does not exist with email:",o),s.NextResponse.json({status:!0,exists:!1,message:"Email not found"});{let e=Math.floor(1e5+9e5*Math.random()).toString(),t=new Date(Date.now()+6e5);console.log("Generated OTP:",e,"Expires at:",t);let r=await a._.user.update({where:{email:o},data:{otp:e,otpExpiresAt:t}});return console.log("User updated:",r),console.log(`OTP for ${o}: ${e}`),await (0,n.B)(o,e,i.fullName),s.NextResponse.json({status:!0,exists:!0,message:"OTP sent to your email"})}}catch(e){return console.error("Error in check-email route:",e),s.NextResponse.json({status:!1,error:"Internal server error"},{status:500})}}o()}catch(e){o(e)}})},5325:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.d(t,{Z:()=>e});var s=r(2051),a=r(6445),i=r(3937),n=r(4652),l=r(8491),c=r(5378),p=r(7856),u=r(8028),d=r(1545),x=r(3514),h=r(1176);let e=({otp:e,fullName:t})=>{let r={color:"#555555",fontSize:"16px",lineHeight:"24px",margin:"16px 0",textAlign:"left"},o={color:"#2e7d32",textDecoration:"underline"};return(0,s.jsxs)(a.V,{children:[s.jsx(i.F,{}),s.jsx(n.M,{children:"Your Rotaract Earth Initiative Login PIN"}),s.jsx(l.u,{style:{backgroundColor:"#f9f9f9",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif"},children:(0,s.jsxs)(c.W,{style:{backgroundColor:"#ffffff",margin:"0 auto",padding:"24px",marginBottom:"64px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[s.jsx(p.$,{style:{backgroundColor:"#2e7d32",borderRadius:"8px 8px 0 0",padding:"24px",textAlign:"center"},children:s.jsx(u.E,{src:"https://firebasestorage.googleapis.com/v0/b/beacon-hostels.appspot.com/o/images%2Frota.png?alt=media&token=33d522ff-88b1-4096-a60a-b1f2665600e8",width:"120",height:"auto",alt:"Rotaract Earth Initiative Logo",style:{margin:"0 auto",width:"120px",height:"auto"}})}),s.jsx(d.X,{style:{color:"#333333",fontSize:"24px",fontWeight:"bold",margin:"32px 0 16px",padding:"0",textAlign:"center"},children:"ONE TIME LOGIN"}),(0,s.jsxs)(x.x,{style:r,children:["Hey, ",t]}),s.jsx(x.x,{style:r,children:"Just a quick reminder that your one-time login PIN is:"}),s.jsx(p.$,{style:{backgroundColor:"#f0f0f0",borderRadius:"4px",padding:"16px",textAlign:"center",margin:"24px 0",fontSize:"32px",fontWeight:"bold",color:"#2e7d32"},children:e}),s.jsx(x.x,{style:r,children:"This PIN will expire shortly for security reasons. Please do not share it with anyone."}),(0,s.jsxs)(x.x,{style:r,children:["If you encounter any issues, don't hesitate to reach out to our friendly support team at"," ",s.jsx(h.r,{href:"mailto:support@rotaract.com",style:o,children:"support@rotaract.com"}),"."]}),s.jsx(x.x,{style:r,children:"Happy logging in!"}),(0,s.jsxs)(x.x,{style:r,children:["Yours truly,",s.jsx("br",{}),s.jsx("strong",{children:"Rotaract Earth Initiative"})]}),(0,s.jsxs)(x.x,{style:{color:"#8898aa",fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"32px"},children:["\xa9 ",new Date().getFullYear()," Rotaract Earth Initiative. All rights reserved.",s.jsx("br",{}),s.jsx(h.r,{href:"https://rotaract.com/",style:o,children:"rotaract.com"})]})]})})]})};o()}catch(e){o(e)}})},7662:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.d(t,{B:()=>c});var s=r(5325),a=r(6742),i=r(2755),n=e([s,i]);[s,i]=n.then?(await n)():n;let l=a.createTransport({service:process.env.EMAIL_SERVICE,auth:{user:process.env.EMAIL_USER,pass:process.env.EMAIL_PASS}}),c=async(e,t,r)=>{try{let o=await (0,i.sY)((0,s.Z)({otp:t,fullName:r}));await l.sendMail({from:'"REI Support" <info@scintl.com>',to:e,subject:"REI 25th Login One Time Pin",html:o}),console.log(`OTP email sent to ${e}`)}catch(e){console.error("Error sending OTP email:",e)}};o()}catch(e){o(e)}})},9483:(e,t,r)=>{r.d(t,{_:()=>s});var o=r(3524);let s=globalThis.prisma||new o.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[379,309,140,432],()=>r(5448));module.exports=o})();