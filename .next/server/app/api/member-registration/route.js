"use strict";(()=>{var e={};e.id=788,e.ids=[788],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1212:e=>{e.exports=require("async_hooks")},1282:e=>{e.exports=require("child_process")},4770:e=>{e.exports=require("crypto")},665:e=>{e.exports=require("dns")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},3757:e=>{e.exports=import("prettier/plugins/html")},5747:e=>{e.exports=import("prettier/standalone")},4492:e=>{e.exports=require("node:stream")},122:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>p,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>x,staticGenerationAsyncStorage:()=>d});var o=t(3278),a=t(5002),i=t(4877),n=t(7175),l=e([n]);n=(l.then?(await l)():l)[0];let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/member-registration/route",pathname:"/api/member-registration",filename:"route",bundlePath:"app/api/member-registration/route"},resolvedPagePath:"D:\\aggi\\projects\\rotaract-member-payments\\app\\api\\member-registration\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:x}=c,h="/api/member-registration/route";function p(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:d})}s()}catch(e){s(e)}})},7175:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{POST:()=>p});var o=t(1309),a=t(3524),i=t(9628),n=t(7662),l=e([n]);n=(l.then?(await l)():l)[0];let c=new a.PrismaClient,u=i.z.object({email:i.z.string().email(),fullName:i.z.string().min(1,"Full name is required")});async function p(e){try{let r=await e.json(),t=u.safeParse(r);if(!t.success)return o.NextResponse.json({error:"Invalid input"},{status:400});let{email:s,fullName:a}=t.data,i=Math.floor(1e5+9e5*Math.random()).toString(),l=new Date(Date.now()+6e5);return await c.user.create({data:{email:s,fullName:a,otp:i,otpExpiresAt:l}}),await (0,n.B)(s,i,a),console.log(`Registration OTP for ${s}: ${i}`),o.NextResponse.json({status:!0,message:"User registered, OTP sent"})}catch(e){if(console.error("Error in registration:",e),e instanceof Error&&e.message.includes("user creation"))return o.NextResponse.json({status:!0,message:"User registered but OTP email failed to send",error:"Email delivery failed"},{status:200});return o.NextResponse.json({error:"Internal server error"},{status:500})}}s()}catch(e){s(e)}})},5325:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.d(r,{Z:()=>e});var o=t(2051),a=t(6445),i=t(3937),n=t(4652),l=t(8491),p=t(5378),c=t(7856),u=t(8028),d=t(1545),x=t(3514),h=t(1176);let e=({otp:e,fullName:r})=>{let t={color:"#555555",fontSize:"16px",lineHeight:"24px",margin:"16px 0",textAlign:"left"},s={color:"#2e7d32",textDecoration:"underline"};return(0,o.jsxs)(a.V,{children:[o.jsx(i.F,{}),o.jsx(n.M,{children:"Your Rotaract Earth Initiative Login PIN"}),o.jsx(l.u,{style:{backgroundColor:"#f9f9f9",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif"},children:(0,o.jsxs)(p.W,{style:{backgroundColor:"#ffffff",margin:"0 auto",padding:"24px",marginBottom:"64px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:[o.jsx(c.$,{style:{backgroundColor:"#2e7d32",borderRadius:"8px 8px 0 0",padding:"24px",textAlign:"center"},children:o.jsx(u.E,{src:"https://firebasestorage.googleapis.com/v0/b/beacon-hostels.appspot.com/o/images%2Frota.png?alt=media&token=33d522ff-88b1-4096-a60a-b1f2665600e8",width:"120",height:"auto",alt:"Rotaract Earth Initiative Logo",style:{margin:"0 auto",width:"120px",height:"auto"}})}),o.jsx(d.X,{style:{color:"#333333",fontSize:"24px",fontWeight:"bold",margin:"32px 0 16px",padding:"0",textAlign:"center"},children:"ONE TIME LOGIN"}),(0,o.jsxs)(x.x,{style:t,children:["Hey, ",r]}),o.jsx(x.x,{style:t,children:"Just a quick reminder that your one-time login PIN is:"}),o.jsx(c.$,{style:{backgroundColor:"#f0f0f0",borderRadius:"4px",padding:"16px",textAlign:"center",margin:"24px 0",fontSize:"32px",fontWeight:"bold",color:"#2e7d32"},children:e}),o.jsx(x.x,{style:t,children:"This PIN will expire shortly for security reasons. Please do not share it with anyone."}),(0,o.jsxs)(x.x,{style:t,children:["If you encounter any issues, don't hesitate to reach out to our friendly support team at"," ",o.jsx(h.r,{href:"mailto:support@rotaract.com",style:s,children:"support@rotaract.com"}),"."]}),o.jsx(x.x,{style:t,children:"Happy logging in!"}),(0,o.jsxs)(x.x,{style:t,children:["Yours truly,",o.jsx("br",{}),o.jsx("strong",{children:"Rotaract Earth Initiative"})]}),(0,o.jsxs)(x.x,{style:{color:"#8898aa",fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"32px"},children:["\xa9 ",new Date().getFullYear()," Rotaract Earth Initiative. All rights reserved.",o.jsx("br",{}),o.jsx(h.r,{href:"https://rotaract.com/",style:s,children:"rotaract.com"})]})]})})]})};s()}catch(e){s(e)}})},7662:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.d(r,{B:()=>p});var o=t(5325),a=t(6742),i=t(2755),n=e([o,i]);[o,i]=n.then?(await n)():n;let l=a.createTransport({service:process.env.EMAIL_SERVICE,auth:{user:process.env.EMAIL_USER,pass:process.env.EMAIL_PASS}}),p=async(e,r,t)=>{try{let s=await (0,i.sY)((0,o.Z)({otp:r,fullName:t}));await l.sendMail({from:'"REI Support" <info@scintl.com>',to:e,subject:"REI 25th Login One Time Pin",html:s}),console.log(`OTP email sent to ${e}`)}catch(e){console.error("Error sending OTP email:",e)}};s()}catch(e){s(e)}})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[379,309,140,432],()=>t(122));module.exports=s})();